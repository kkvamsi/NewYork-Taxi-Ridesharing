import beatrix

# File containing the code for extracting grids for the grid based algorithm

__author__ = 'vamsi'

grid_data=[
[(-73.959499, 40.872536),
(-73.884640, 40.872542),
(-73.884630, 40.819423),
(-73.959484, 40.819427)],

[(-73.884613, 40.872340),
(-73.807978, 40.872312),
(-73.807960, 40.819406),
(-73.884614, 40.819419)],

[(-73.808054, 40.872512),
(-73.731214, 40.872495),
(-73.731198, 40.819360),
(-73.808097, 40.819376)],

[(-74.034401, 40.819867),
(-73.959171, 40.819825),
(-73.959170, 40.766672),
(-74.034353, 40.766666)],

[(-73.959241, 40.819621),
(-73.8846186, 40.8194040),
(-73.884532, 40.766724),
(-73.959243, 40.766724)],


[(-73.8846186, 40.8194155),
(-73.807488, 40.819417),
(-73.807490, 40.766774),
(-73.884623, 40.766776)],

[(-73.807491, 40.819408),
(-73.7305840, 40.8194057),
(-73.730589, 40.767034),
(-73.807487, 40.767034)],

[(-74.034337, 40.766655),
(-73.959317, 40.766656),
(-73.959332, 40.713476),
(-74.034346, 40.713466)],

[(-73.9592294, 40.7666951),
(-73.884210, 40.766700),
(-73.8842119, 40.7138247),
(-73.959227, 40.713830)],

[(-73.884290, 40.766754),
(-73.807464, 40.766752),
(-73.807465, 40.713726),
(-73.884283, 40.713726)],

[(-73.807635, 40.767094),
(-73.730648, 40.767090),
(-73.730645, 40.713927),
(-73.807635, 40.713924)],

[(-74.034428, 40.713429),
(-73.958892, 40.713421),
(-73.958890, 40.660120),
(-74.034420, 40.660122)],

[(-73.958890, 40.713803),
(-73.884104, 40.713804),
(-73.884110, 40.660098),
(-73.958906, 40.660087)],

[(-73.884133, 40.713663),
(-73.807615, 40.713663),
(-73.807615, 40.660168),
(-73.884134, 40.660170)],

[(-73.807599, 40.713947),
(-73.730529, 40.713952),
(-73.730524, 40.660452),
(-73.8075993, 40.6604490)],

[(-74.259993, 40.659238),
(-74.184392, 40.659185),
(-74.184398, 40.606556),
(-74.259925, 40.606552)],

[(-74.184326, 40.659246),
(-74.110335, 40.659156),
(-74.110324, 40.606550),
(-74.184328, 40.606616)],

[(-74.110270, 40.659304),
(-74.034481, 40.659291),
(-74.034483, 40.606783),
(-74.110260, 40.606783)],

[(-74.034394, 40.660082),
(-73.959198, 40.660090),
(-73.959203, 40.606808),
(-74.034386, 40.606801)],

[(-73.959125, 40.660037),
(-73.8839436, 40.6600387),
(-73.883944, 40.606887),
(-73.959132, 40.606892)],

[(-73.883944, 40.660201),
(-73.807260, 40.660205),
(-73.807255, 40.606923),
(-73.8839427, 40.6069197)],

[(-73.807256, 40.660449),
(-73.7306084, 40.6604488),
(-73.730607, 40.607042),
(-73.807254, 40.607038)],

[(-74.259895, 40.606574),
(-74.184394, 40.606547),
(-74.184536, 40.552990),
(-74.259893, 40.552987)],


[(-74.184612, 40.606612),
(-74.110116, 40.606612),
(-74.110105, 40.553025),
(-74.184608, 40.553022)],

[(-74.110056, 40.606839),
(-74.034615, 40.606838),
(-74.034614, 40.553126),
(-74.110060, 40.553130)],

[(-74.034586, 40.606725),
(-73.959732, 40.606727),
(-73.959732, 40.552882),
(-74.034585, 40.552887)],

[(-73.959565, 40.606916),
(-73.883695, 40.606918),
(-73.883692, 40.552942),
(-73.959567, 40.552950)],

[(-73.883634, 40.606900),
(-73.807162, 40.606899),
(-73.807158, 40.552928),
(-73.883633, 40.552928)],

[(-73.807083, 40.607034),
(-73.730694, 40.607039),
(-73.730757, 40.552997),
(-73.807085, 40.552932)],

[(-74.260021, 40.552989),
(-74.184663, 40.552983),
(-74.184662, 40.499487),
(-74.2600231, 40.4994847)],

[(-74.1844477, 40.5530792),
(-74.109942, 40.553081),
(-74.109968, 40.499403),
(-74.184447, 40.499387)]]


def process_grid_data():
     sourcedata=open('/home/vamsi/Databases_sqlLite/taxi_extract_2015_yellow_jan_1_sorted.csv','r')
     print(sourcedata)
     for trans in sourcedata:
        x=trans.split(',')
        y1=float(x[9])
        y2=float(x[10])


        for eachGrid in grid_data:
             if beatrix.point_in_poly(y1,y2,eachGrid):
                 print(grid_data.index(eachGrid))






if __name__=='__main__':
    process_grid_data()
